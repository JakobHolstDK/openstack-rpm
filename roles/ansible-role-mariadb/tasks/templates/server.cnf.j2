#Manage by asible-role-mariadb

[client]
port = 3306
socket = /var/lib/mysql/mysql.sock
#ssl-ca = /etc/pki/ca-trust/source/anchors/puppet_openstack.pem
#ssl-cert = /etc/my.cnf.d/ssl/mariadb.crt
#ssl-key = /etc/my.cnf.d/ssl/private/api-a.ostack.met.no.pem

[isamchk]
key_buffer_size = 16M

[mysqld]
basedir = /usr
bind-address = 0.0.0.0
binlog_format = ROW
datadir = /var/lib/mysql
default_storage_engine = InnoDB
expire_logs_days = 10
innodb_autoinc_lock_mode = 2
innodb_locks_unsafe_for_binlog = 1
key_buffer_size = 16M
log-error = /var/log/mariadb/mariadb.log
max_allowed_packet = 16M
max_binlog_size = 100M
max_connections = 5000
pid-file = /var/run/mariadb/mariadb.pid
port = 3306
query_cache_size = 0
query_cache_type = 0
skip-external-locking
socket = /var/lib/mysql/mysql.sock
ssl = false
#ssl-ca = /etc/pki/ca-trust/source/anchors/puppet_openstack.pem
#ssl-cert = /etc/pki/ca-trust/source/anchors/puppet_openstack.pem
#ssl-key = /etc/my.cnf.d/ssl/private/api-a.ostack.met.no.pem
thread_cache_size = 8
thread_stack = 256K
tmpdir = /tmp
user = mysql
wsrep_cluster_address = gcomm://{{ ansible_role_mariadb_node1}},{{ ansible_role_mariadb_node2} /
wsrep_node_address = {{ inventory_hostname }}
wsrep_node_incoming_address = {{ inventory_hostname }}
wsrep_on = ON
wsrep_provider = /usr/lib64/galera/libgalera_smm.so
#wsrep_provider_options = socket.ssl_key=/etc/my.cnf.d/ssl/private/api-a.ostack.met.no.pem;socket.ssl_cert=/etc/pki/ca-trust/source/anchors/puppet_openstack.pem;socket.ssl_ca=/etc/pki/ca-trust/source/anchors/puppet_openstack.pem;socket.checksum=2;socket.ssl_cipher=AES128-SHA256
wsrep_slave_threads = 8
wsrep_sst_auth = "root:chee5rie7aiNgiwie0eiqueko"
wsrep_sst_method = rsync
wsrep_sst_receive_address = {{ inventory_hostname }}

[mysqld-5.0]
myisam-recover = BACKUP

[mysqld-5.1]
myisam-recover = BACKUP

[mysqld-5.5]
myisam-recover = BACKUP
query_cache_limit = 1M
query_cache_size = 16M

[mysqld-5.6]
myisam-recover-options = BACKUP
query_cache_limit = 1M
query_cache_size = 16M

[mysqld-5.7]
myisam-recover-options = BACKUP
query_cache_limit = 1M
query_cache_size = 16M

[mysqld_safe]
log-error = /var/log/mariadb/mariadb.log
nice = 0
socket = /var/lib/mysql/mysql.sock

[mysqldump]
max_allowed_packet = 16M
quick
quote-names

